<div class="test-result-container">
  <div *ngIf="isLoading" class="loading-message">
    <p>Loading your test results...</p>
  </div>

  <div *ngIf="!isLoading && testResults.length === 0" class="no-results">
    <h3>No Test Results Yet</h3>
    <p>You haven't taken any tests yet. Start by taking your first test!</p>
  </div>

  <div *ngIf="!isLoading && testResults.length > 0">
    <div class="results-header">
      <h2>Your Test Results</h2>
      <p>Track your progress and performance across all tests</p>
    </div>

    <table class="result-table">
      <thead>
        <tr>
          <th>Test Name</th>
          <th>Date Taken</th>
          <th>Duration</th>
          <th>Score</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let result of testResults; let i = index">
          <td>
            <div class="test-name-cell">
              <span class="test-name">{{ result.testName }}</span>
            </div>
          </td>
          <td>{{ formatDate(result.endTime) }}</td>
          <td>{{ formatDuration(result.duration) }}</td>
          <td>
            <div class="score-cell">
              <span class="score-percentage">{{ result.percentage }}%</span>
            </div>
          </td>
          <td>
            <span
              class="status-badge"
              [class.pass]="result.status === 'Pass'"
              [class.fail]="result.status === 'Fail'"
            >
              {{ result.status }}
            </span>
          </td>
          <td>
            <button
              class="view-btn"
              (click)="onClickAnalytics(result)"
              title="View detailed analytics"
            >
              View Analytics
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<app-chart
  [isChartVisible]="isChartVisible"
  [testResult]="selectedTestResult"
  (closeChart)="onCloseChart()"
/>
